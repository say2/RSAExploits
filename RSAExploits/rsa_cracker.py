""" RSA_Cracker: Cracks RSA key set by using various attacks """

from RSAExploits.exploits.common_modulus import Common_Modulus
from RSAExploits.exploits.wiener import Wiener
from RSAExploits.exploits.boneh_durfee import Boneh_Durfee
from RSAExploits.exploits.hastad import Hastad
from RSAExploits.exploits.fermat import Fermat
from RSAExploits.exploits.common_factor import Common_Factor
from RSAExploits.exploits.franklin_reiter import Franklin_Reiter

exploit_classes = []

def init():
    global exploit_classes 

    exploit_classes = []
    exploit_classes.append(Franklin_Reiter())
    exploit_classes.append(Common_Modulus())
    exploit_classes.append(Common_Factor())
    exploit_classes.append(Wiener())
    exploit_classes.append(Boneh_Durfee())
    exploit_classes.append(Hastad())
    exploit_classes.append(Fermat())

def attack(rsadata_list, info_dict = None, break_on_success = True):
    success = False
    for exploit in exploit_classes:
        if exploit.run(rsadata_list, info_dict):
            success = True
        if success and break_on_success:
            return success

